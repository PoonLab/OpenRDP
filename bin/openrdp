#! /usr/bin/env python3
import argparse
import openrdp
import os

all_methods = tuple(openrdp.aliases.keys())
parser = argparse.ArgumentParser(
    description='An open source implementation of RDP5.\n'
)
parser.add_argument('infile',
                    help='File containing sequence alignment (FASTA or CLUSTAL) format')
parser.add_argument('outfile', help='Path to the output file')
parser.add_argument('-c', '--cfg',
                    help='Path to file that contains parameters.  Defaults to '
                         'default_config.ini.',
                    default=os.path.join(openrdp.__path__[0],
                                         'default_config.ini'))
parser.add_argument('-m', '--methods', nargs='+',
                    help="Space-delimited list of recombination methods to run. "
                         f"Permitted values are: {{{' '.join(all_methods)}}}. "
                         "All methods are run if not specified.",
                    choices=all_methods, metavar="")
parser.add_argument('-q', '--quiet', help='Hide progress messages',
                    action='store_true')
args = parser.parse_args()

if args.methods is None:
    args.methods = all_methods  # run all methods by default

results = openrdp.openrdp(args.infile, args.outfile, cfg=args.cfg,
                          methods=tuple(args.methods), quiet=args.quiet)
print(results)  # calls custom object method
